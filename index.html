<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABA Development Support</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            text-align: center;
        }
        header {
            background-color: #4CAF50;
            color: white;
            padding: 1em;
        }
        nav a {
            color: white;
            margin: 0 1em;
            text-decoration: none;
        }
        section {
            padding: 2em;
            margin: 1em;
            background-color: white;
            border-radius: 8px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        iframe { max-width: 100%; }
        button { padding: 10px 20px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #45a049; }
        input, textarea { width: 100%; padding: 10px; margin: 10px 0; }
        .lesson { display: flex; flex-wrap: wrap; gap: 1em; justify-content: center; }
        .lesson div { flex: 1; min-width: 300px; }
        @media (max-width: 600px) {
            section { margin: 0.5em; padding: 1em; }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <header>
        <h1>ABA Development Support</h1>
        <nav>
            <a href="#checklist">Development Checklist</a>
            <a href="#lessons">Mini Lessons</a>
            <a href="#tracker">Progress Tracker</a>
            <a href="#qa">Q&A</a>
        </nav>
    </header>

    <!-- Development Checklist -->
    <section id="checklist">
        <h2>Development Checklist</h2>
        <label>Select your child's age:</label>
        <select id="age">
            <option value="2">2 years</option>
            <option value="3">3 years</option>
            <option value="4">4 years</option>
        </select>
        <p>Does your child use two-word phrases? (e.g., "Mommy, ball")</p>
        <button onclick="checkMilestone()">Check</button>
        <p id="result"></p>
    </section>

    <!-- Mini Lessons (Videos Only) -->
    <section id="lessons">
        <h2>Mini Lessons</h2>
        <p>Simple ABA activities for home (5 minutes a day!)</p>
        <div id="video-container" class="lesson"></div>
        <p><a href="#tracker">Track your progress!</a></p>
    </section>

    <!-- ABA Starter Pack -->
    <section id="starter-pack">
        <h2>ABA Starter Pack</h2>
        <p>Download a guide for ABA at home (PDF)</p>
        <button onclick="generatePDF()">Download</button>
    </section>

    <!-- Progress Tracker -->
    <section id="tracker">
        <h2>Progress Tracker</h2>
        <input type="text" id="task" placeholder="e.g., Number of words spoken">
        <button onclick="addProgress()">Record</button>
        <canvas id="progressChart"></canvas>
    </section>

    <!-- Q&A Forum -->
    <section id="qa">
        <h2>Q&A Forum</h2>
        <input type="text" id="question" placeholder="e.g., How to handle tantrums?">
        <button onclick="askQuestion()">Ask</button>
        <p id="answer"></p>
        <h3>Community Questions</h3>
        <div id="forum"></div>
    </section>

    <!-- Footer -->
    <footer>
        <h3>Resources</h3>
        <p><a href="https://www.mhlw.go.jp/stf/seisakunitsuite/bunya/hukushi_kaigo/shougaishahukushi/service/shien.html">Japan Developmental Support Centers</a></p>
    </footer>

    <script>
        // Load Videos
        fetch("assets/data/videos.json")
            .then(response => response.json())
            .then(videos => {
                const container = document.getElementById("video-container");
                container.innerHTML = videos.map(video => `
                    <div>
                        <h3>${video.title}</h3>
                        <iframe width="560" height="315" src="${video.url}" frameborder="0" allowfullscreen></iframe>
                    </div>
                `).join("");
            });

        // Checklist
        fetch("assets/data/milestones.json")
            .then(response => response.json())
            .then(milestones => {
                window.checkMilestone = function() {
                    const age = document.getElementById("age").value;
                    const result = document.getElementById("result");
                    result.innerHTML = `If concerned, try the <a href="#starter-pack">ABA Starter Pack</a> or <a href="#lessons">Mini Lessons</a>!`;
                };
            });

        // PDF Generation
        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.text("ABA Starter Pack", 10, 10);
            doc.text("1. What is ABA? A method to encourage behaviors!", 10, 20);
            doc.text("2. Activity: Clap Your Hands (Imitation)", 10, 30);
            doc.text("3. Activity: Say 'Juice' (Request)", 10, 40);
            doc.text("4. Progress: 5 minutes a day is enough!", 10, 50);
            doc.save("aba-starter-pack.pdf");
        }

        // Progress Tracker
        let progressData = JSON.parse(localStorage.getItem("progress")) || [];
        const ctx = document.getElementById("progressChart").getContext("2d");
        const chart = new Chart(ctx, {
            type: "line",
            data: {
                labels: [],
                datasets: [{ label: "Words Spoken", data: [], borderColor: "#4CAF50" }]
            }
        });
        function addProgress() {
            const task = document.getElementById("task").value;
            if (task) {
                progressData.push(parseInt(task) || 0);
                localStorage.setItem("progress", JSON.stringify(progressData));
                chart.data.labels.push(new Date().toLocaleDateString());
                chart.data.datasets[0].data = progressData;
                chart.update();
            }
        }

        // Q&A Forum
        fetch("assets/data/qa-rules.json")
            .then(response => response.json())
            .then(qaRules => {
                let forumPosts = JSON.parse(localStorage.getItem("forum")) || [];
                document.getElementById("forum").innerHTML = forumPosts.map(p => `<p><b>Q:</b> ${p.question}<br><b>A:</b> ${p.response}</p>`).join("");
                
                window.askQuestion = function() {
                    const question = document.getElementById("question").value;
                    const answer = document.getElementById("answer");
                    const forum = document.getElementById("forum");
                    let response = qaRules[question] || "Consider consulting a specialist!";
                    answer.innerHTML = response;
                    forumPosts.push({ question, response });
                    localStorage.setItem("forum", JSON.stringify(forumPosts));
                    forum.innerHTML = forumPosts.map(p => `<p><b>Q:</b> ${p.question}<br><b>A:</b> ${p.response}</p>`).join("");
                };
            });
    </script>
</body>
</html>
